{
  "info": {"version": "1.0.0", "title": "User Management API"},
  "paths": {
    "/rest/orgs": {
      "get": {
        "operationId": "get_organizations",
        "responses": {
          "200": {"description": "OK", "schema": {"type": "array", "items": {"$ref": "Organization"}}}
        }
      },
	  "post": {
        "operationId": "create_organization",
        "parameters": [{"name": "body", "in": "body", "schema": {"$ref": "OrgNameRequest"}}],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "201": {"description": "Created", "schema": {"type": "string"}}
        }
	  }
	},
    "/rest/orgs/{organization_guid}": {
      "delete": {
        "operationId": "delete_organization",
        "parameters": [{"name": "organization_guid", "in": "path", "required": "true", "type": "string"}],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "204": {"description": "No Content", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/orgs/{organization_guid}/name": {
      "put": {
        "operationId": "rename_organization",
        "parameters": [
          {"name": "organization_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "body", "in": "body", "schema": {"$ref": "OrgNameRequest"}}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "201": {"description": "Created", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/orgs/{organization_guid}/users": {
      "get": {
        "operationId": "get_organization_users",
        "parameters": [{"name": "organization_guid", "in": "path", "required": "true", "type": "string"}],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "array", "items": {"$ref": "User"}}}
        }
      },
      "post": {
        "operationId": "create_organization_user",
        "parameters": [
          {"name": "organization_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "body", "in": "body", "schema": {"$ref": "UserRequest"}}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"$ref": "User"}},
          "201": {"description": "Created", "schema": {"type": "string"}},
          "400": {"description": "Error", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/orgs/{organization_guid}/users/{user_guid}": {
      "delete": {
        "operationId": "delete_organization_user",
        "parameters": [
          {"name": "organization_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "user_guid", "in": "path", "required": "true", "type": "string"}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "204": {"description": "No Content", "schema": {"type": "string"}}
        }
      },
      "put": {
        "operationId": "update_organization_user",
        "parameters": [
          {"name": "organization_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "user_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "body", "in": "body", "schema": {"$ref": "UserRequest"}}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "201": {"description": "Created", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/spaces/{space_guid}/users": {
      "get": {
        "operationId": "get_space_users",
        "parameters": [{"name": "space_guid", "in": "path", "required": "true", "type": "string"}],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "array", "items": {"$ref": "User"}}}
        }
      },
      "post": {
        "operationId": "create_space_user",
        "parameters": [
          {"name": "space_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "body", "in": "body", "schema": {"$ref": "UserRequest"}}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "201": {"description": "Created", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/spaces/{space_guid}/users/{user_guid}": {
      "delete": {
        "operationId": "delete_space_user",
        "parameters": [
          {"name": "space_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "user_guid", "in": "path", "required": "true", "type": "string"}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "204": {"description": "No Content", "schema": {"type": "string"}}
        }
      },
      "put": {
        "operationId": "update_space_user",
        "parameters": [
          {"name": "space_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "user_guid", "in": "path", "required": "true", "type": "string"},
          {"name": "body", "in": "body", "schema": {"$ref": "UserRequest"}}
        ],
        "responses": {
          "200": {"description": "OK", "schema": {"type": "string"}},
          "201": {"description": "Created", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/registrations": {
      "post": {
        "operationId": "register_org_and_user",
        "parameters": [
          {"name": "code", "in": "query", "type": "string"},
          {"name": "body", "in": "body", "schema": {"$ref": "Registration"}}
        ],
        "responses": {
          "200": {"description": "", "schema": {"$ref": "Registration"}},
          "201": {"description": "Created", "schema": {"type": "string"}},
          "401": {"description": "Unauthorized", "schema": {"type": "string"}},
          "403": {"description": "Forbidden", "schema": {"type": "string"}},
          "404": {"description": "Not Found", "schema": {"type": "string"}}
        }
      }
    },
    "/rest/invitations": {
      "post": {
        "operationId": "invite_user",
        "parameters": [
          {"name": "body", "in": "body", "schema": {"$ref": "Invitation"}}
        ],
        "responses": {
          "200": {"description": "", "schema": {"$ref": "InvitationDetails"}},
          "201": {"description": "Created", "schema": {"type": "string"}},
          "401": {"description": "Unauthorized", "schema": {"type": "string"}},
          "403": {"description": "Forbidden", "schema": {"type": "string"}},
          "404": {"description": "Not Found",  "schema": {"type": "string"}}
        }
      }
    }
  },
  "definitions": {
    "OrgNameRequest": {
      "properties": {"name": {"type": "string"}}
    },
    "Organization": {
      "properties": {
        "guid": {"type": "string"},
        "name": {"type": "string"},
        "manager": {"type": "boolean"},
        "spaces": {
          "type": "array",
          "items": {"$ref": "SpaceInfo"}
        }
      }
    },
    "SpaceInfo": {
      "properties": {
        "guid": {"type": "string"},
        "name": {"type": "string"}
      }
    },
    "UserRequest": {
      "properties": {
        "org_guid": {"type": "string"},
        "roles": {"type": "array", "items": {"type": "string"}},
        "username": {"type": "string"}
      }
    },
    "User": {
      "properties": {
        "guid": {"type": "string"},
        "org_guid": {"type": "string"},
        "roles": {"type": "array", "items": {"type": "string", "enum": ["managers", "auditors", "billing_managers"]}},
        "username": {"type": "string"}
      }
    },
    "Registration": {
      "properties": {
        "password": {"type": "string"},
        "org": {"type": "string"}
      }
    },
    "Invitation": {
      "properties": {
        "email": {"type": "string"}
      }
    },
    "InvitationDetails": {
      "properties": {
        "details": {"type": "string"}
      }
    }
  },
  "security": [{"default": []}],
  "swagger": "2.0",
  "consumes": ["application/json"]
}